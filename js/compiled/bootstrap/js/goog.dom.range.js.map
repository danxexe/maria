{
"version":3,
"file":"goog.dom.range.js",
"lineCount":145,
"mappings":"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",
"sources":["goog/dom/range.js"],
"sourcesContent":["// Copyright 2007 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for working with ranges in HTML documents.\n *\n * @author robbyw@google.com (Robby Walker)\n * @suppress {strictMissingProperties}\n */\n\ngoog.provide('goog.dom.Range');\n\ngoog.require('goog.dom');\ngoog.require('goog.dom.AbstractRange');\ngoog.require('goog.dom.BrowserFeature');\ngoog.require('goog.dom.ControlRange');\ngoog.require('goog.dom.MultiRange');\ngoog.require('goog.dom.NodeType');\ngoog.require('goog.dom.TextRange');\n\n\n/**\n * Create a new selection from the given browser window's current selection.\n * Note that this object does not auto-update if the user changes their\n * selection and should be used as a snapshot.\n * @param {Window=} opt_win The window to get the selection of.  Defaults to the\n *     window this class was defined in.\n * @return {goog.dom.AbstractRange?} A range wrapper object, or null if there\n *     was an error.\n */\ngoog.dom.Range.createFromWindow = function(opt_win) {\n  var sel =\n      goog.dom.AbstractRange.getBrowserSelectionForWindow(opt_win || window);\n  return sel && goog.dom.Range.createFromBrowserSelection(sel);\n};\n\n\n/**\n * Create a new range wrapper from the given browser selection object.  Note\n * that this object does not auto-update if the user changes their selection and\n * should be used as a snapshot.\n * @param {!Object} selection The browser selection object.\n * @return {goog.dom.AbstractRange?} A range wrapper object or null if there\n *    was an error.\n */\ngoog.dom.Range.createFromBrowserSelection = function(selection) {\n  var range;\n  var isReversed = false;\n  if (selection.createRange) {\n\n    try {\n      range = selection.createRange();\n    } catch (e) {\n      // Access denied errors can be thrown here in IE if the selection was\n      // a flash obj or if there are cross domain issues\n      return null;\n    }\n  } else if (selection.rangeCount) {\n    if (selection.rangeCount > 1) {\n      return goog.dom.MultiRange.createFromBrowserSelection(\n          /** @type {!Selection} */ (selection));\n    } else {\n      range = selection.getRangeAt(0);\n      isReversed = goog.dom.Range.isReversed(\n          selection.anchorNode, selection.anchorOffset, selection.focusNode,\n          selection.focusOffset);\n    }\n  } else {\n    return null;\n  }\n\n  return goog.dom.Range.createFromBrowserRange(range, isReversed);\n};\n\n\n/**\n * Create a new range wrapper from the given browser range object.\n * @param {Range|TextRange} range The browser range object.\n * @param {boolean=} opt_isReversed Whether the focus node is before the anchor\n *     node.\n * @return {!goog.dom.AbstractRange} A range wrapper object.\n */\ngoog.dom.Range.createFromBrowserRange = function(range, opt_isReversed) {\n  // Create an IE control range when appropriate.\n  return goog.dom.AbstractRange.isNativeControlRange(range) ?\n      goog.dom.ControlRange.createFromBrowserRange(range) :\n      goog.dom.TextRange.createFromBrowserRange(range, opt_isReversed);\n};\n\n\n/**\n * Create a new range wrapper that selects the given node's text.\n * @param {Node} node The node to select.\n * @param {boolean=} opt_isReversed Whether the focus node is before the anchor\n *     node.\n * @return {!goog.dom.AbstractRange} A range wrapper object.\n */\ngoog.dom.Range.createFromNodeContents = function(node, opt_isReversed) {\n  return goog.dom.TextRange.createFromNodeContents(node, opt_isReversed);\n};\n\n\n/**\n * Create a new range wrapper that represents a caret at the given node,\n * accounting for the given offset.  This always creates a TextRange, regardless\n * of whether node is an image node or other control range type node.\n * @param {Node} node The node to place a caret at.\n * @param {number} offset The offset within the node to place the caret at.\n * @return {!goog.dom.AbstractRange} A range wrapper object.\n */\ngoog.dom.Range.createCaret = function(node, offset) {\n  return goog.dom.TextRange.createFromNodes(node, offset, node, offset);\n};\n\n\n/**\n * Create a new range wrapper that selects the area between the given nodes,\n * accounting for the given offsets.\n * @param {Node} anchorNode The node to anchor on.\n * @param {number} anchorOffset The offset within the node to anchor on.\n * @param {Node} focusNode The node to focus on.\n * @param {number} focusOffset The offset within the node to focus on.\n * @return {!goog.dom.AbstractRange} A range wrapper object.\n */\ngoog.dom.Range.createFromNodes = function(\n    anchorNode, anchorOffset, focusNode, focusOffset) {\n  return goog.dom.TextRange.createFromNodes(\n      anchorNode, anchorOffset, focusNode, focusOffset);\n};\n\n\n/**\n * Clears the window's selection.\n * @param {Window=} opt_win The window to get the selection of.  Defaults to the\n *     window this class was defined in.\n */\ngoog.dom.Range.clearSelection = function(opt_win) {\n  var sel =\n      goog.dom.AbstractRange.getBrowserSelectionForWindow(opt_win || window);\n  if (!sel) {\n    return;\n  }\n  if (sel.empty) {\n    // We can't just check that the selection is empty, because IE\n    // sometimes gets confused.\n    try {\n      sel.empty();\n    } catch (e) {\n      // Emptying an already empty selection throws an exception in IE\n    }\n  } else {\n    try {\n      sel.removeAllRanges();\n    } catch (e) {\n      // This throws in IE9 if the range has been invalidated; for example, if\n      // the user clicked on an element which disappeared during the event\n      // handler.\n    }\n  }\n};\n\n\n/**\n * Tests if the window has a selection.\n * @param {Window=} opt_win The window to check the selection of.  Defaults to\n *     the window this class was defined in.\n * @return {boolean} Whether the window has a selection.\n */\ngoog.dom.Range.hasSelection = function(opt_win) {\n  var sel =\n      goog.dom.AbstractRange.getBrowserSelectionForWindow(opt_win || window);\n  return !!sel &&\n      (goog.dom.BrowserFeature.LEGACY_IE_RANGES ? sel.type != 'None' :\n                                                  !!sel.rangeCount);\n};\n\n\n/**\n * Returns whether the focus position occurs before the anchor position.\n * @param {Node} anchorNode The node to anchor on.\n * @param {number} anchorOffset The offset within the node to anchor on.\n * @param {Node} focusNode The node to focus on.\n * @param {number} focusOffset The offset within the node to focus on.\n * @return {boolean} Whether the focus position occurs before the anchor\n *     position.\n */\ngoog.dom.Range.isReversed = function(\n    anchorNode, anchorOffset, focusNode, focusOffset) {\n  if (anchorNode == focusNode) {\n    return focusOffset < anchorOffset;\n  }\n  var child;\n  if (anchorNode.nodeType == goog.dom.NodeType.ELEMENT && anchorOffset) {\n    child = anchorNode.childNodes[anchorOffset];\n    if (child) {\n      anchorNode = child;\n      anchorOffset = 0;\n    } else if (goog.dom.contains(anchorNode, focusNode)) {\n      // If focus node is contained in anchorNode, it must be before the\n      // end of the node.  Hence we are reversed.\n      return true;\n    }\n  }\n  if (focusNode.nodeType == goog.dom.NodeType.ELEMENT && focusOffset) {\n    child = focusNode.childNodes[focusOffset];\n    if (child) {\n      focusNode = child;\n      focusOffset = 0;\n    } else if (goog.dom.contains(focusNode, anchorNode)) {\n      // If anchor node is contained in focusNode, it must be before the\n      // end of the node.  Hence we are not reversed.\n      return false;\n    }\n  }\n  return (goog.dom.compareNodeOrder(anchorNode, focusNode) ||\n          anchorOffset - focusOffset) > 0;\n};\n"],
"names":["goog","provide","require","dom","Range","createFromWindow","goog.dom.Range.createFromWindow","opt_win","sel","AbstractRange","getBrowserSelectionForWindow","window","createFromBrowserSelection","goog.dom.Range.createFromBrowserSelection","selection","range","isReversed","createRange","e","rangeCount","MultiRange","getRangeAt","anchorNode","anchorOffset","focusNode","focusOffset","createFromBrowserRange","goog.dom.Range.createFromBrowserRange","opt_isReversed","isNativeControlRange","ControlRange","TextRange","createFromNodeContents","goog.dom.Range.createFromNodeContents","node","createCaret","goog.dom.Range.createCaret","offset","createFromNodes","goog.dom.Range.createFromNodes","clearSelection","goog.dom.Range.clearSelection","empty","removeAllRanges","hasSelection","goog.dom.Range.hasSelection","BrowserFeature","LEGACY_IE_RANGES","type","goog.dom.Range.isReversed","child","nodeType","NodeType","ELEMENT","childNodes","contains","compareNodeOrder"]
}
