{
"version":3,
"file":"goog.dom.controlrange.js",
"lineCount":261,
"mappings":"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",
"sources":["goog/dom/controlrange.js"],
"sourcesContent":["// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Utilities for working with IE control ranges.\n *\n * @author robbyw@google.com (Robby Walker)\n * @suppress {strictMissingProperties}\n */\n\n\ngoog.provide('goog.dom.ControlRange');\ngoog.provide('goog.dom.ControlRangeIterator');\n\ngoog.require('goog.array');\ngoog.require('goog.dom');\ngoog.require('goog.dom.AbstractMultiRange');\ngoog.require('goog.dom.AbstractRange');\ngoog.require('goog.dom.RangeIterator');\ngoog.require('goog.dom.RangeType');\ngoog.require('goog.dom.SavedRange');\ngoog.require('goog.dom.TagWalkType');\ngoog.require('goog.dom.TextRange');\ngoog.require('goog.iter.StopIteration');\ngoog.require('goog.userAgent');\n\n\n\n/**\n * Create a new control selection with no properties.  Do not use this\n * constructor: use one of the goog.dom.Range.createFrom* methods instead.\n * @constructor\n * @extends {goog.dom.AbstractMultiRange}\n * @final\n */\ngoog.dom.ControlRange = function() {\n  /**\n   * The IE control range obejct.\n   * @private {?Object}\n   */\n  this.range_ = null;\n\n  /**\n   * Cached list of elements.\n   * @private {?Array<?Element>}\n   */\n  this.elements_ = null;\n\n  /**\n   * Cached sorted list of elements.\n   * @private {?Array<?Element>}\n   */\n  this.sortedElements_ = null;\n};\ngoog.inherits(goog.dom.ControlRange, goog.dom.AbstractMultiRange);\n\n\n/**\n * Create a new range wrapper from the given browser range object.  Do not use\n * this method directly - please use goog.dom.Range.createFrom* instead.\n * @param {Object} controlRange The browser range object.\n * @return {!goog.dom.ControlRange} A range wrapper object.\n */\ngoog.dom.ControlRange.createFromBrowserRange = function(controlRange) {\n  var range = new goog.dom.ControlRange();\n  range.range_ = controlRange;\n  return range;\n};\n\n\n/**\n * Create a new range wrapper that selects the given element.  Do not use\n * this method directly - please use goog.dom.Range.createFrom* instead.\n * @param {...Element} var_args The element(s) to select.\n * @return {!goog.dom.ControlRange} A range wrapper object.\n */\ngoog.dom.ControlRange.createFromElements = function(var_args) {\n  var range = goog.dom.getOwnerDocument(arguments[0]).body.createControlRange();\n  for (var i = 0, len = arguments.length; i < len; i++) {\n    range.addElement(arguments[i]);\n  }\n  return goog.dom.ControlRange.createFromBrowserRange(range);\n};\n\n\n// Method implementations\n\n\n/**\n * Clear cached values.\n * @private\n */\ngoog.dom.ControlRange.prototype.clearCachedValues_ = function() {\n  this.elements_ = null;\n  this.sortedElements_ = null;\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.clone = function() {\n  return goog.dom.ControlRange.createFromElements.apply(\n      this, this.getElements());\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getType = function() {\n  return goog.dom.RangeType.CONTROL;\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getBrowserRangeObject = function() {\n  return this.range_ || document.body.createControlRange();\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.setBrowserRangeObject = function(nativeRange) {\n  if (!goog.dom.AbstractRange.isNativeControlRange(nativeRange)) {\n    return false;\n  }\n  this.range_ = nativeRange;\n  return true;\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getTextRangeCount = function() {\n  return this.range_ ? this.range_.length : 0;\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getTextRange = function(i) {\n  return goog.dom.TextRange.createFromNodeContents(this.range_.item(i));\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getContainer = function() {\n  return goog.dom.findCommonAncestor.apply(null, this.getElements());\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getStartNode = function() {\n  return this.getSortedElements()[0];\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getStartOffset = function() {\n  return 0;\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getEndNode = function() {\n  var sorted = this.getSortedElements();\n  var startsLast = /** @type {Node} */ (goog.array.peek(sorted));\n  return /** @type {Node} */ (goog.array.find(sorted, function(el) {\n    return goog.dom.contains(el, startsLast);\n  }));\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getEndOffset = function() {\n  return this.getEndNode().childNodes.length;\n};\n\n\n// TODO(robbyw): Figure out how to unify getElements with TextRange API.\n/**\n * @return {!Array<Element>} Array of elements in the control range.\n */\ngoog.dom.ControlRange.prototype.getElements = function() {\n  if (!this.elements_) {\n    this.elements_ = [];\n    if (this.range_) {\n      for (var i = 0; i < this.range_.length; i++) {\n        this.elements_.push(this.range_.item(i));\n      }\n    }\n  }\n\n  return this.elements_;\n};\n\n\n/**\n * @return {!Array<Element>} Array of elements comprising the control range,\n *     sorted by document order.\n */\ngoog.dom.ControlRange.prototype.getSortedElements = function() {\n  if (!this.sortedElements_) {\n    this.sortedElements_ = this.getElements().concat();\n    this.sortedElements_.sort(function(a, b) {\n      return a.sourceIndex - b.sourceIndex;\n    });\n  }\n\n  return this.sortedElements_;\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.isRangeInDocument = function() {\n  var returnValue = false;\n\n  try {\n    returnValue = goog.array.every(this.getElements(), function(element) {\n      // On IE, this throws an exception when the range is detached.\n      return goog.userAgent.IE ?\n          !!element.parentNode :\n          goog.dom.contains(element.ownerDocument.body, element);\n    });\n  } catch (e) {\n    // IE sometimes throws Invalid Argument errors for detached elements.\n    // Note: trying to return a value from the above try block can cause IE\n    // to crash.  It is necessary to use the local returnValue.\n  }\n\n  return returnValue;\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.isCollapsed = function() {\n  return !this.range_ || !this.range_.length;\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getText = function() {\n  // TODO(robbyw): What about for table selections?  Should those have text?\n  return '';\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getHtmlFragment = function() {\n  return goog.array.map(this.getSortedElements(), goog.dom.getOuterHtml)\n      .join('');\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getValidHtml = function() {\n  return this.getHtmlFragment();\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.getPastableHtml =\n    goog.dom.ControlRange.prototype.getValidHtml;\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.__iterator__ = function(opt_keys) {\n  return new goog.dom.ControlRangeIterator(this);\n};\n\n\n// RANGE ACTIONS\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.select = function() {\n  if (this.range_) {\n    this.range_.select();\n  }\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.removeContents = function() {\n  // TODO(robbyw): Test implementing with execCommand('Delete')\n  if (this.range_) {\n    var nodes = [];\n    for (var i = 0, len = this.range_.length; i < len; i++) {\n      nodes.push(this.range_.item(i));\n    }\n    goog.array.forEach(nodes, goog.dom.removeNode);\n\n    this.collapse(false);\n  }\n};\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.replaceContentsWithNode = function(node) {\n  // Control selections have to have the node inserted before removing the\n  // selection contents because a collapsed control range doesn't have start or\n  // end nodes.\n  var result = this.insertNode(node, true);\n\n  if (!this.isCollapsed()) {\n    this.removeContents();\n  }\n\n  return result;\n};\n\n\n// SAVE/RESTORE\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.saveUsingDom = function() {\n  return new goog.dom.DomSavedControlRange_(this);\n};\n\n\n// RANGE MODIFICATION\n\n\n/** @override */\ngoog.dom.ControlRange.prototype.collapse = function(toAnchor) {\n  // TODO(robbyw): Should this return a text range?  If so, API needs to change.\n  this.range_ = null;\n  this.clearCachedValues_();\n};\n\n\n// SAVED RANGE OBJECTS\n\n\n\n/**\n * A SavedRange implementation using DOM endpoints.\n * @param {goog.dom.ControlRange} range The range to save.\n * @constructor\n * @extends {goog.dom.SavedRange}\n * @private\n */\ngoog.dom.DomSavedControlRange_ = function(range) {\n  /**\n   * The element list.\n   * @type {Array<Element>}\n   * @private\n   */\n  this.elements_ = range.getElements();\n};\ngoog.inherits(goog.dom.DomSavedControlRange_, goog.dom.SavedRange);\n\n\n/** @override */\ngoog.dom.DomSavedControlRange_.prototype.restoreInternal = function() {\n  var doc = this.elements_.length ?\n      goog.dom.getOwnerDocument(this.elements_[0]) :\n      document;\n  var controlRange = doc.body.createControlRange();\n  for (var i = 0, len = this.elements_.length; i < len; i++) {\n    controlRange.addElement(this.elements_[i]);\n  }\n  return goog.dom.ControlRange.createFromBrowserRange(controlRange);\n};\n\n\n/** @override */\ngoog.dom.DomSavedControlRange_.prototype.disposeInternal = function() {\n  goog.dom.DomSavedControlRange_.superClass_.disposeInternal.call(this);\n  delete this.elements_;\n};\n\n\n// RANGE ITERATION\n\n\n\n/**\n * Subclass of goog.dom.TagIterator that iterates over a DOM range.  It\n * adds functions to determine the portion of each text node that is selected.\n *\n * @param {goog.dom.ControlRange?} range The range to traverse.\n * @constructor\n * @extends {goog.dom.RangeIterator}\n * @final\n */\ngoog.dom.ControlRangeIterator = function(range) {\n  /**\n   * The first node in the selection.\n   * @private {?Node}\n   */\n  this.startNode_ = null;\n\n  /**\n   * The last node in the selection.\n   * @private {?Node}\n   */\n  this.endNode_ = null;\n\n  /**\n   * The list of elements left to traverse.\n   * @private {Array<?Element>?}\n   */\n  this.elements_ = null;\n\n  if (range) {\n    this.elements_ = range.getSortedElements();\n    this.startNode_ = this.elements_.shift();\n    this.endNode_ = /** @type {Node} */ (goog.array.peek(this.elements_)) ||\n        this.startNode_;\n  }\n\n  goog.dom.ControlRangeIterator.base(\n      this, 'constructor', this.startNode_, false);\n};\ngoog.inherits(goog.dom.ControlRangeIterator, goog.dom.RangeIterator);\n\n\n/** @override */\ngoog.dom.ControlRangeIterator.prototype.getStartTextOffset = function() {\n  return 0;\n};\n\n\n/** @override */\ngoog.dom.ControlRangeIterator.prototype.getEndTextOffset = function() {\n  return 0;\n};\n\n\n/** @override */\ngoog.dom.ControlRangeIterator.prototype.getStartNode = function() {\n  return this.startNode_;\n};\n\n\n/** @override */\ngoog.dom.ControlRangeIterator.prototype.getEndNode = function() {\n  return this.endNode_;\n};\n\n\n/** @override */\ngoog.dom.ControlRangeIterator.prototype.isLast = function() {\n  return !this.depth && !this.elements_.length;\n};\n\n\n/**\n * Move to the next position in the selection.\n * Throws `goog.iter.StopIteration` when it passes the end of the range.\n * @return {Node} The node at the next position.\n * @override\n */\ngoog.dom.ControlRangeIterator.prototype.next = function() {\n  // Iterate over each element in the range, and all of its children.\n  if (this.isLast()) {\n    throw goog.iter.StopIteration;\n  } else if (!this.depth) {\n    var el = this.elements_.shift();\n    this.setPosition(\n        el, goog.dom.TagWalkType.START_TAG, goog.dom.TagWalkType.START_TAG);\n    return el;\n  }\n\n  // Call the super function.\n  return goog.dom.ControlRangeIterator.superClass_.next.call(this);\n};\n\n\n/** @override */\ngoog.dom.ControlRangeIterator.prototype.copyFrom = function(other) {\n  var that = /** @type {!goog.dom.ControlRangeIterator} */ (other);\n  this.elements_ = that.elements_;\n  this.startNode_ = that.startNode_;\n  this.endNode_ = that.endNode_;\n\n  goog.dom.ControlRangeIterator.superClass_.copyFrom.call(this, that);\n};\n\n\n/**\n * @return {!goog.dom.ControlRangeIterator} An identical iterator.\n * @override\n */\ngoog.dom.ControlRangeIterator.prototype.clone = function() {\n  var copy = new goog.dom.ControlRangeIterator(null);\n  copy.copyFrom(this);\n  return copy;\n};\n"],
"names":["goog","provide","require","dom","ControlRange","goog.dom.ControlRange","range_","elements_","sortedElements_","inherits","AbstractMultiRange","createFromBrowserRange","goog.dom.ControlRange.createFromBrowserRange","controlRange","range","createFromElements","goog.dom.ControlRange.createFromElements","var_args","getOwnerDocument","arguments","body","createControlRange","i","len","length","addElement","prototype","clearCachedValues_","goog.dom.ControlRange.prototype.clearCachedValues_","clone","goog.dom.ControlRange.prototype.clone","apply","getElements","getType","goog.dom.ControlRange.prototype.getType","RangeType","CONTROL","getBrowserRangeObject","goog.dom.ControlRange.prototype.getBrowserRangeObject","document","setBrowserRangeObject","goog.dom.ControlRange.prototype.setBrowserRangeObject","nativeRange","AbstractRange","isNativeControlRange","getTextRangeCount","goog.dom.ControlRange.prototype.getTextRangeCount","getTextRange","goog.dom.ControlRange.prototype.getTextRange","TextRange","createFromNodeContents","item","getContainer","goog.dom.ControlRange.prototype.getContainer","findCommonAncestor","getStartNode","goog.dom.ControlRange.prototype.getStartNode","getSortedElements","getStartOffset","goog.dom.ControlRange.prototype.getStartOffset","getEndNode","goog.dom.ControlRange.prototype.getEndNode","sorted","startsLast","array","peek","find","el","contains","getEndOffset","goog.dom.ControlRange.prototype.getEndOffset","childNodes","goog.dom.ControlRange.prototype.getElements","push","goog.dom.ControlRange.prototype.getSortedElements","concat","sort","a","b","sourceIndex","isRangeInDocument","goog.dom.ControlRange.prototype.isRangeInDocument","returnValue","every","element","userAgent","IE","parentNode","ownerDocument","e","isCollapsed","goog.dom.ControlRange.prototype.isCollapsed","getText","goog.dom.ControlRange.prototype.getText","getHtmlFragment","goog.dom.ControlRange.prototype.getHtmlFragment","map","getOuterHtml","join","getValidHtml","goog.dom.ControlRange.prototype.getValidHtml","getPastableHtml","__iterator__","goog.dom.ControlRange.prototype.__iterator__","opt_keys","ControlRangeIterator","select","goog.dom.ControlRange.prototype.select","removeContents","goog.dom.ControlRange.prototype.removeContents","nodes","forEach","removeNode","collapse","replaceContentsWithNode","goog.dom.ControlRange.prototype.replaceContentsWithNode","node","result","insertNode","saveUsingDom","goog.dom.ControlRange.prototype.saveUsingDom","DomSavedControlRange_","goog.dom.ControlRange.prototype.collapse","toAnchor","goog.dom.DomSavedControlRange_","SavedRange","restoreInternal","goog.dom.DomSavedControlRange_.prototype.restoreInternal","doc","disposeInternal","goog.dom.DomSavedControlRange_.prototype.disposeInternal","superClass_","call","goog.dom.ControlRangeIterator","startNode_","endNode_","shift","base","RangeIterator","getStartTextOffset","goog.dom.ControlRangeIterator.prototype.getStartTextOffset","getEndTextOffset","goog.dom.ControlRangeIterator.prototype.getEndTextOffset","goog.dom.ControlRangeIterator.prototype.getStartNode","goog.dom.ControlRangeIterator.prototype.getEndNode","isLast","goog.dom.ControlRangeIterator.prototype.isLast","depth","next","goog.dom.ControlRangeIterator.prototype.next","iter","StopIteration","setPosition","TagWalkType","START_TAG","copyFrom","goog.dom.ControlRangeIterator.prototype.copyFrom","other","that","goog.dom.ControlRangeIterator.prototype.clone","copy"]
}
